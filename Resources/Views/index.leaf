<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hokusai - Hybrid Image Processing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-swift.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" media="(prefers-color-scheme: dark)">
    <style>
        .dark pre[class*="language-"],
        .dark code[class*="language-"] {
            background: #1e293b !important;
            color: #e2e8f0 !important;
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        border: "hsl(214.3 31.8% 91.4%)",
                        input: "hsl(214.3 31.8% 91.4%)",
                        ring: "hsl(222.2 84% 4.9%)",
                        background: "hsl(0 0% 100%)",
                        foreground: "hsl(222.2 84% 4.9%)",
                        primary: {
                            DEFAULT: "hsl(222.2 47.4% 11.2%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        secondary: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(222.2 47.4% 11.2%)",
                        },
                        muted: {
                            DEFAULT: "hsl(210 40% 96.1%)",
                            foreground: "hsl(215.4 16.3% 46.9%)",
                        },
                    },
                }
            }
        }
    </script>
    <style>
        .nav-item {
            display: block;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
            border-radius: 0.375rem;
        }
        .nav-item:hover {
            background-color: hsl(210 40% 96.1%);
        }
        .dark .nav-item:hover {
            background-color: hsl(217.2 32.6% 17.5%);
        }
        .nav-item.active {
            background-color: hsl(210 40% 96.1%);
            font-weight: 500;
        }
        .dark .nav-item.active {
            background-color: hsl(217.2 32.6% 17.5%);
        }
        pre[class*="language-"] {
            border-radius: 0.375rem;
            font-size: 0.875rem;
            margin: 0;
        }
        .feature-section {
            display: none;
        }
        .feature-section.active {
            display: block;
        }
    </style>
</head>
<body class="bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50">
    <div class="flex h-screen overflow-hidden">
        <!-- Left Sidebar -->
        <aside class="w-64 border-r border-slate-200 dark:border-slate-800 flex flex-col flex-shrink-0">
            <div class="p-6 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between">
                <div>
                    <h1 class="text-xl font-bold">Hokusai</h1>
                    <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Image Processing</p>
                </div>
                <button id="theme-toggle" class="p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                    <svg id="theme-toggle-dark-icon" class="hidden w-4 h-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-4 h-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
                <a href="#" class="nav-item active" onclick="switchFeature(event, 'text')">Text Overlay</a>
                <a href="#" class="nav-item" onclick="switchFeature(event, 'resize')">Resize Image</a>
                <a href="#" class="nav-item" onclick="switchFeature(event, 'convert')">Convert Format</a>
                <a href="#" class="nav-item" onclick="switchFeature(event, 'rotate')">Rotate Image</a>
                <!-- Composite temporarily disabled due to vips_composite2 bug -->
                <!-- <a href="#" class="nav-item" onclick="switchFeature(event, 'composite')">Watermark/Composite</a> -->
                <a href="#" class="nav-item" onclick="switchFeature(event, 'cert')">Generate Certificate</a>
                <a href="#" class="nav-item" onclick="switchFeature(event, 'meta')">Image Metadata</a>
            </nav>
            <div class="p-4 border-t border-slate-200 dark:border-slate-800 text-xs text-slate-500 dark:text-slate-400">
                <a href="https://github.com/ivantokar/hokusai" class="hover:text-slate-900 dark:hover:text-slate-50 underline">GitHub</a>
            </div>
        </aside>

        <!-- Center Content -->
        <main class="flex-1 overflow-y-auto p-8">
            <!-- Text Overlay -->
            <div id="text-section" class="feature-section active max-w-2xl">
                <h2 class="text-2xl font-semibold mb-2">Text Overlay</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Add text with custom fonts, strokes, and effects using ImageMagick</p>

                <form action="/demo/text" method="post" enctype="multipart/form-data" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Image</label>
                        <input type="file" name="image" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Text</label>
                        <input type="text" name="text" placeholder="Hello World" required
                               class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Font Size</label>
                            <input type="number" name="fontSize" value="48"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Stroke Width</label>
                            <input type="number" name="strokeWidth" value="2" step="0.1"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Process Image
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">cURL</h3>
                        <pre><code class="language-bash">curl -X POST http://localhost:8080/demo/text \
  -F "image=@photo.jpg" \
  -F "text=Hello World" \
  -F "fontSize=64" \
  -F "strokeWidth=2" \
  -o output.jpg</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let image = try await Hokusai.image(from: "photo.jpg")

var textOptions = TextOptions()
textOptions.font = "DejaVu-Sans"
textOptions.fontSize = 64
textOptions.color = [255, 255, 255, 255]
textOptions.strokeColor = [0, 0, 0, 255]
textOptions.strokeWidth = 2.0

let result = try image.drawText(
    "Hello World",
    x: try image.width / 2,
    y: try image.height / 2,
    options: textOptions
)

try result.toFile("output.jpg", quality: 90)</code></pre>
                    </div>
                </div>
            </div>

            <!-- Resize Image -->
            <div id="resize-section" class="feature-section max-w-2xl">
                <h2 class="text-2xl font-semibold mb-2">Resize Image</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">High-performance resizing with multiple fit modes using libvips</p>

                <form action="/demo/resize" method="post" enctype="multipart/form-data" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Image</label>
                        <input type="file" name="image" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Width</label>
                            <input type="number" name="width" placeholder="800"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Height</label>
                            <input type="number" name="height" placeholder="600"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Fit Mode</label>
                        <select name="fit" class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                            <option value="inside">Inside (preserve aspect ratio)</option>
                            <option value="cover">Cover (crop to fill)</option>
                            <option value="fill">Fill (stretch to fit)</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Resize Image
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-muted-foreground">cURL</h3>
                        <pre><code class="language-bash">curl -X POST http://localhost:8080/demo/resize \
  -F "image=@photo.jpg" \
  -F "width=800" \
  -F "height=600" \
  -F "fit=inside" \
  -o resized.jpg</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let image = try await Hokusai.image(from: "photo.jpg")

var options = ResizeOptions()
options.fit = .inside

let resized = try image.resize(
    width: 800,
    height: 600,
    options: options
)

try resized.toFile("output.jpg", quality: 85)</code></pre>
                    </div>
                </div>
            </div>

            <!-- Convert Format -->
            <div id="convert-section" class="feature-section max-w-2xl">
                <h2 class="text-2xl font-semibold mb-2">Convert Format</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Convert between JPEG, PNG, WebP, AVIF, and GIF formats</p>

                <form action="/demo/convert" method="post" enctype="multipart/form-data" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Image</label>
                        <input type="file" name="image" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Output Format</label>
                        <select name="format" class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                            <option value="jpeg">JPEG</option>
                            <option value="png">PNG</option>
                            <option value="webp">WebP</option>
                            <option value="avif">AVIF</option>
                            <option value="gif">GIF</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Quality (1-100)</label>
                        <input type="number" name="quality" value="85" min="1" max="100"
                               class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Convert Image
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-muted-foreground">cURL</h3>
                        <pre><code class="language-bash">curl -X POST http://localhost:8080/demo/convert \
  -F "image=@photo.jpg" \
  -F "format=webp" \
  -F "quality=80" \
  -o output.webp</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let image = try await Hokusai.image(from: "photo.jpg")

try image.toFile("output.webp", quality: 80)</code></pre>
                    </div>
                </div>
            </div>

            <!-- Rotate Image -->
            <div id="rotate-section" class="feature-section max-w-2xl">
                <h2 class="text-2xl font-semibold mb-2">Rotate Image</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Fast 90°, 180°, and 270° rotations</p>

                <form action="/demo/rotate" method="post" enctype="multipart/form-data" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Image</label>
                        <input type="file" name="image" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Rotation</label>
                        <select name="angle" class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                            <option value="90">90° clockwise</option>
                            <option value="180">180°</option>
                            <option value="270">270° clockwise</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Rotate Image
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-muted-foreground">cURL</h3>
                        <pre><code class="language-bash">curl -X POST http://localhost:8080/demo/rotate \
  -F "image=@photo.jpg" \
  -F "angle=90" \
  -o rotated.jpg</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let image = try await Hokusai.image(from: "photo.jpg")

let rotated = try image.rotate(angle: .degree90)

try rotated.toFile("output.jpg", quality: 85)</code></pre>
                    </div>
                </div>
            </div>

            <!-- Watermark/Composite - DISABLED: vips_composite2 bug causes server crash -->
            <div id="composite-section" class="feature-section max-w-2xl" style="display: none;">
                <h2 class="text-2xl font-semibold mb-2">Watermark/Composite</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Overlay images with position, opacity, and blend modes</p>

                <form action="/demo/composite" method="post" enctype="multipart/form-data" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Base Image</label>
                        <input type="file" name="baseImage" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Watermark/Overlay Image</label>
                        <input type="file" name="overlayImage" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">X Position</label>
                            <input type="number" name="x" value="10" min="0"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Y Position</label>
                            <input type="number" name="y" value="10" min="0"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Opacity (0.0-1.0)</label>
                            <input type="number" name="opacity" value="1.0" min="0" max="1" step="0.1"
                                   class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Blend Mode</label>
                            <select name="mode" class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                                <option value="over">Over (default)</option>
                                <option value="add">Add (lighten)</option>
                                <option value="multiply">Multiply (darken)</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Apply Watermark
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">cURL</h3>
                        <pre><code class="language-bash">curl -X POST http://localhost:8080/demo/composite \
  -F "baseImage=@photo.jpg" \
  -F "overlayImage=@watermark.png" \
  -F "x=10" \
  -F "y=10" \
  -F "opacity=0.8" \
  -F "mode=over" \
  -o watermarked.png</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let base = try await Hokusai.image(from: "photo.jpg")
let watermark = try await Hokusai.image(from: "logo.png")

var options = CompositeOptions()
options.mode = .over
options.opacity = 0.8

let watermarked = try base.composite(
    overlay: watermark,
    x: 10,
    y: 10,
    options: options
)

try watermarked.toFile("output.png", quality: 90)</code></pre>
                    </div>
                </div>
            </div>

            <!-- Generate Certificate -->
            <div id="cert-section" class="feature-section max-w-2xl">
                <h2 class="text-2xl font-semibold mb-2">Generate Certificate</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Create personalized certificates with custom fonts</p>

                <form action="/demo/certificate" method="get" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Recipient Name</label>
                        <input type="text" name="name" placeholder="John Doe" required
                               class="w-full px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-md text-sm bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900 dark:focus:ring-slate-50">
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Generate Certificate
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-muted-foreground">cURL</h3>
                        <pre><code class="language-bash">curl -X GET "http://localhost:8080/demo/certificate?name=John%20Doe" \
  -o certificate.png</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let template = try await Hokusai.image(from: "template.png")

var textOptions = TextOptions()
textOptions.font = "/path/to/CustomFont.ttf"
textOptions.fontSize = 96
textOptions.color = [0, 0, 128, 255]
textOptions.strokeColor = [255, 255, 255, 255]
textOptions.strokeWidth = 2.0

let certificate = try template.drawText(
    "John Doe",
    x: try template.width / 2,
    y: Int(Double(try template.height) * 0.6),
    options: textOptions
)

try certificate.toFile("certificate.png", compression: 9)</code></pre>
                    </div>
                </div>
            </div>

            <!-- Image Metadata -->
            <div id="meta-section" class="feature-section max-w-2xl">
                <h2 class="text-2xl font-semibold mb-2">Image Metadata</h2>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Extract image dimensions, format, and properties</p>

                <form action="/demo/metadata" method="post" enctype="multipart/form-data" class="space-y-4 mb-8">
                    <div>
                        <label class="block text-sm font-medium mb-2">Image</label>
                        <input type="file" name="image" accept="image/*" required
                               class="block w-full text-sm border border-slate-200 dark:border-slate-700 rounded-md bg-white dark:bg-slate-900 file:border-0 file:bg-slate-100 dark:file:bg-slate-800 file:text-slate-900 dark:file:text-slate-50 file:px-4 file:py-2 file:mr-4">
                    </div>
                    <button type="submit" class="w-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 px-4 py-2.5 rounded-md text-sm hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors">
                        Get Metadata
                    </button>
                </form>

                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-muted-foreground">cURL</h3>
                        <pre><code class="language-bash">curl -X POST http://localhost:8080/demo/metadata \
  -F "image=@photo.jpg"</code></pre>
                    </div>
                    <div>
                        <h3 class="text-sm font-semibold mb-2 text-slate-500 dark:text-slate-400">Swift</h3>
                        <pre><code class="language-swift">let image = try await Hokusai.image(from: "photo.jpg")
let metadata = try image.metadata()

print("Width: \(metadata.width)")
print("Height: \(metadata.height)")
print("Format: \(metadata.format?.rawValue ?? "unknown")")
print("Channels: \(metadata.channels)")
print("Has Alpha: \(metadata.hasAlpha)")</code></pre>
                    </div>
                </div>
            </div>
        </main>

        <!-- Right Results Panel -->
        <aside class="w-96 border-l border-slate-200 dark:border-slate-800 flex flex-col flex-shrink-0 bg-slate-50 dark:bg-slate-900/50">
            <div class="p-4 border-b border-slate-200 dark:border-slate-800">
                <h3 class="text-sm font-semibold">Result</h3>
            </div>
            <div class="flex-1 overflow-y-auto p-4">
                <div class="result-content">
                    <div class="text-center text-slate-500 dark:text-slate-400 text-sm py-12">
                        <p>Upload and process an image to see the result here</p>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <script>
        // Theme toggle
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

        // Check for saved theme preference or default to 'light'
        const currentTheme = localStorage.getItem('theme') || 'light';

        // Set initial theme
        if (currentTheme === 'dark') {
            document.documentElement.classList.add('dark');
            themeToggleLightIcon.classList.remove('hidden');
        } else {
            document.documentElement.classList.remove('dark');
            themeToggleDarkIcon.classList.remove('hidden');
        }

        // Toggle theme
        themeToggleBtn.addEventListener('click', function() {
            // Toggle icons
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');

            // Toggle dark mode
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
        });

        function switchFeature(event, feature) {
            event.preventDefault();

            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update visible section
            document.querySelectorAll('.feature-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(feature + '-section').classList.add('active');

            // Scroll to top
            document.querySelector('main').scrollTop = 0;

            // Trigger syntax highlighting
            Prism.highlightAll();
        }

        // Handle form submissions
        async function handleFormSubmit(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);
            const resultPanel = document.querySelector('.result-content');

            // Show loading state
            resultPanel.innerHTML = '<div class="text-center text-slate-500 dark:text-slate-400 text-sm py-12"><p>Processing...</p></div>';

            try {
                // Build fetch options
                const fetchOptions = {
                    method: form.method.toUpperCase()
                };

                // For GET requests, append form data to URL as query params
                // For POST/PUT requests, send as body
                let url = form.action;
                if (fetchOptions.method === 'GET') {
                    const params = new URLSearchParams(formData);
                    url = url + '?' + params.toString();
                } else {
                    fetchOptions.body = formData;
                }

                const response = await fetch(url, fetchOptions);

                if (!response.ok) {
                    throw new Error('Request failed: ' + response.statusText);
                }

                const contentType = response.headers.get('content-type');

                if (contentType && contentType.includes('application/json')) {
                    // Handle JSON response (metadata)
                    const data = await response.json();
                    resultPanel.innerHTML = '<pre class="text-sm bg-slate-100 dark:bg-slate-800 p-4 rounded-md overflow-auto">' +
                        JSON.stringify(data, null, 2) + '</pre>';
                } else if (contentType && contentType.startsWith('image/')) {
                    // Handle image response
                    const blob = await response.blob();
                    const imageUrl = URL.createObjectURL(blob);
                    resultPanel.innerHTML = '<img src="' + imageUrl + '" class="max-w-full h-auto rounded-md border border-slate-200 dark:border-slate-700" />';
                } else {
                    resultPanel.innerHTML = '<div class="text-sm text-slate-500 dark:text-slate-400">Result received (unknown format)</div>';
                }
            } catch (error) {
                resultPanel.innerHTML = '<div class="text-sm text-red-600 dark:text-red-400 p-4">Error: ' + error.message + '</div>';
            }
        }

        // Initial syntax highlighting
        document.addEventListener('DOMContentLoaded', function() {
            Prism.highlightAll();

            // Attach form handlers
            document.querySelectorAll('form').forEach(form => {
                form.addEventListener('submit', handleFormSubmit);
            });
        });
    </script>
</body>
</html>
